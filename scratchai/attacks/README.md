This section takes reference from the tf cleverhans library
